# -----------------------------
# âœ… CI/CD Workflow by Aparna
# -----------------------------

name: CI-CD Demo Workflow

# ğŸ‘‡ Controls when the workflow will run
on:
  push:
    branches: [ "main" ]    # Runs when you push to main branch
  pull_request:
    branches: [ "main" ]    # Also runs on pull requests to main
  workflow_dispatch:         # Allows manual run from Actions tab

# ğŸ‘‡ Define jobs (Build/Test + Deploy)
jobs:
  build_and_test:
    name: Build and Test (CI)
    runs-on: ubuntu-latest   # GitHub provides a virtual Ubuntu runner

    steps:
      # Step 1ï¸âƒ£ Checkout your repository
      - name: Checkout repository
        uses: actions/checkout@v4

      # Step 2ï¸âƒ£ Run AWS Sustainability Scanner (as part of CI)
      - name: AWS Sustainability Scanner
        uses: aws-actions/sustainability-scanner@v1

      # Step 3ï¸âƒ£ Simulate running build/tests
      - name: Run tests
        run: |
          echo "âœ… Running project tests..."
          echo "âœ… All tests passed successfully!"

  deploy:
    name: Deploy (CD)
    runs-on: ubuntu-latest
    needs: build_and_test    # Wait until CI finishes successfully
    if: success()            # Run only if CI succeeded

    steps:
      # Step 1ï¸âƒ£ Checkout again (required for deployment step)
      - name: Checkout repository
        uses: actions/checkout@v4

      # Step 2ï¸âƒ£ Simulate Deployment (you can replace with real deploy commands later)
      - name: Deploy to Server (Simulation)
        run: |
          echo "ğŸš€ Starting Deployment..."
          echo "ğŸ“¦ Uploading files to server..."
          echo "âœ… Deployment completed successfully!"
